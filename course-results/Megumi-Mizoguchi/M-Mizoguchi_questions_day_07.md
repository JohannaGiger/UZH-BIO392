# BIO392-day-07 Questions 

## Practical

### Q1
**Does the sequence quality graph of your data look different from the examples shown in the slides? Are there any adapter sequences in the data? Why do you think this is?**
The sequence quality graph looks very different from typical real data examples.
A drop in the average quality score across all reads toward the end of the read is common in real data (due to sequencing chemistry issues).
However, instead of variation in base quality across the read length, there is a single, constant quality score of 62 across all positions. According to Feifei, this is unrealistically perfect and indicates that the data was simulated rather than generated by an actual sequencer.

FastQC shows:
"Adapter Content" passed, meaning no adapter sequences were detected, because this dataset was artificially generated.
Most other quality checks also passed (except GC content, which often fails in simulated data due to lack of natural variability).


### Q2
**Given the FastQC reports, does it make sense to perform adapter and/or quality-trimming on your data?**
Trimming is not necessary in this case. There are no low-quality regions to remove. No adapter contamination is present.


### Q3
**Why are so many files in the bioinformatics pipeline compressed and indexed?**
Genomic datasets are huge.
To handle them, 
- Compression reduces file size, saving disk space and speeding up data transfer.
- Indexing enables fast random access to specific regions of large files without having to read the entire file.

Without compression and indexing, analyses would be slower and more memory-intensive.

In our exercise, the files in the directory ~/project-day-07/data/reference/ are:
APC.fa: Reference genome (FASTA file)
APC.fa.fai: Used by samtools faidx to quickly fetch sequences from large FASTA files.
APC.fa.* (amb, ann, bwt, pac, 0123): Used by bwa to align reads to the genome efficiently.


### Q4
**In the bash script that processes alignment files, you will see calls to samtools sort, samtools view, and samtools index (among others). Explain what these three programs do. Why do you think each program is needed?**
*Hint: look at the [Samtools manual](http://www.htslib.org/doc/samtools.html)*.
* samtools view
    Converts a .sam file (text format) into a .bam file (binary format), making the file smaller and faster to process.

* samtools sort
    Sorts the .bam file by the genomic coordinates, being required by many downstream tools (e.g. for variant calling).

* samtools index
    Creates an index (.bai file) for the .bam file, allowing fast random access to specific regions in the file.


### Q5
**Explain what files are needed for GangSTR to run. Specifically: explain what information is provided to GangSTR via the --ref, --region, and --bam command line arguments.**
*Hint: look at the [GangSTR manual](https://github.com/gymreklab/gangstr).*
--ref
**File: APC.fa (reference genome)**
provides the genomic sequence that reads were aligned to. 
GangSTR uses this to determine where the STRs (Short Tandem Repeats) are located and to interpret read alignments correctly.

--regions
**File: APC_repeats.tsv**
contains the coordinates and repeat motifs of known STR regions in the reference genome.
GangSTR uses it to focus its genotyping only on these specified regions (instead of scanning the entire genome).

--bam
**File: patient_X.bam (e.g. patient_1.bam, patient_2.bam, ...)**
contains the aligned sequencing reads from a sample. 
GangSTR analyzes the reads in relation to the reference and the STR regions to estimate the number of repeat units (genotyping).

GangSTR outputs:
*.vcf.gz: STR genotypes in VCF format
samplestats.tab: summary stats for the sample
insdata.tab: detailed info on insertions


## Literature
During the practical so far, you have generated variant calls from short read sequencing data using bioinformatics approaches. Now it's time to take a step back and do some background reading in order to prepare for the analysis and interpretation of the results next week. 

First, read the following sections of [this review](https://www.sciencedirect.com/science/article/pii/S0959437X16301538):
* Abstract
* Introduction``
* Genotyping STRs from high-throughput sequencing data
Then, answer Q6 and Q7.

### Q6
**Why is STR variation relevant to health and disease?**
STR variation is relevant to health and disease because it contributes significantly to human genetic variation and is implicated in a variety of disorders. STR expansions are known to cause conditions such as Fragile X Syndrome and spinal and bulbar muscular atrophy, and have been linked to mechanisms like polyglutamine aggregation, hypermethylation, RNA toxicity, and abnormal translation processes. Smaller STR variants can also affect gene regulation and RNA splicing, as seen in progressive myoclonus epilepsy and cystic fibrosis. Additionally, STRs are predicted to contribute more de novo mutations per generation than any other variant type, suggesting a potential role in spontaneous diseases like autism and neurodevelopmental disorders.

### Q7
**What are some of the challenges in analysing STRs from NGS data?**
- Short reads often do not span the full repeat regions, reducing informativeness.
- STR variations can appear as large insertions or deletions, causing alignment difficulties and biases toward shorter alleles.
- PCR amplification can introduce stutter noise, complicating accurate repeat count determination.
- Standard sequencing pipelines often filter out STRs due to low-quality calls, and even known pathogenic repeats may go undetected.
- Many genotyping tools struggle with low complexity regions and require specialized algorithms to mitigate mapping biases and model errors.

Second, read the following sections of the [paper describing GangSTR](https://academic.oup.com/nar/article/47/15/e90/5518310):
* Abstract
* Introduction
* Overview of the GangSTR model
Then, answer Q6 and Q7.

### Q8
**What sets GangSTR apart from other STR genotyping tools?**
GangSTR stands out from other tools because it is designed for genome-wide genotyping of both short and expanded tandem repeats (TRs) using a unified maximum likelihood framework that integrates multiple sources of information from paired-end reads, enabling it to accurately estimate diploid repeat lengths across a broad spectrum of repeat sizes. It also outperforms other methods in both accuracy and speed, and it does not require a control cohort, unlike some other tools.

### Q9
**What types of information does GangSTR use for STR genotyping?**
GangSTR uses four classes of paired-end read data:
- Enclosing reads (E) – reads that span the entire repeat with flanking regions.
- Spanning reads (S) – pairs where reads map to either side of the repeat.
- Flanking reads (F) – reads that partially extend into the repeat.
- Fully Repetitive Reads (FRR) – reads composed entirely of the repeat motif.
For each class, GangSTR models specific characteristics such as repeat count, observed fragment length, distance from the repeat region, and number of observed copies, integrating this data into a maximum likelihood model to estimate the diploid genotype.
