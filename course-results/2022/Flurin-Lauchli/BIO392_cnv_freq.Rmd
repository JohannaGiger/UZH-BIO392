---
title: "BIO392-cnv-freq"
author: "Flurin Lauchli"
date: "2022-09-28"
output:
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Step 1: Install package

```{r}
if (!require(devtools)){ install.packages('devtools')
}
```
```{r}
devtools::install_github("progenetix/pgxRpi")
```
```{r}
library(pgxRpi)
```


## Step2: Search esophageal adenocarcinoma NCIt code
C4025

## Step3: Access the CNV frequency data from samples with esophageal adenocarcinoma

```{r}
 freq <- pgxLoader(type='frequency', output='pgxseg',filters='NCIT:C4025',
                  codematches=T)
```

### The retreived data is an object contaning two slots `meta` and `data`.

The `meta` slot looks like this:

```{r}
freq$meta
```

The `data` slot includes two matrices.

```{r}
names(freq$data)

```

The frequency matrix looks like this

```{r}
head(freq$data$`NCIT:C4025`)
```

Dimension of this matrix

```{r}
dim(freq$data$"NCIT:C4025")
```

## Step4: Visualize data

### By genome

```{r,fig.width=12,fig.height=6}
pgxFreqplot(freq)
```

### By chromosome

```{r,fig.width=12, fig.height=6}

pgxFreqplot(freq,chrom = 20)
```

## Step5: Analyse the data

According the plot, we can see frequenct gains on chromosome 7p, 8q, 20p,20q 
and frequenct losses on chromosome 4p,4q, 5q, 9p, 17p, 18q, 21q.

There is a literature where the findings are consistent with the majority of mine. Here is the [paper-link](https://www.nature.com/articles/modpathol2008150).

A more detailed use case see this [link](https://htmlpreview.github.io/?https://github.com/progenetix/pgxRpi/blob/main/vignettes/Introduction_2_loadfrequency.html).


compare esophageal adenocarcinoma (NCIT:C4025) with Invasive Breast Carcinoma (NCIT:C9245) and Colon Adenocarcinoma(NCIT:C4349) and Lung Non-Small Cell Carcinoma (NCIT:C2926)

```{r}
 freq1 <- pgxLoader(type='frequency', output='pgxseg',filters='NCIT:C9245',
                  codematches=T)

 freq2 <- pgxLoader(type='frequency', output='pgxseg',filters='NCIT:C4349',
                  codematches=T)
 
freq3 <- pgxLoader(type='frequency', output='pgxseg',filters='NCIT:C2926',
                  codematches=T)

```

```{r}
pgxFreqplot(freq)
pgxFreqplot(freq1)
pgxFreqplot(freq2)
pgxFreqplot(freq3)
```
## closer look at invasice breast carcinoma

```{r}
pgxFreqplot(freq1)
```


chrom 8 of invasice breast carcinoma:
```{r}
pgxFreqplot(freq1,chrom = 8)
```
ca. 1/2 of samples seem to have a loss in chromosome 8p and a gain (duplication?) in chromosome 8q.

X chromosome loss also seems to be prominent:
```{r}
pgxFreqplot(freq1,chrom = 23)
```


closer look at chrom 1:
```{r}
pgxFreqplot(freq1,chrom = 1)
```
50% of samples have a gain in chromosome 1q
