---
title: "BIO392-cnv-freq"
author: "kim wild"
date: ""
output:
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Step 1: Install package

```{r}

if (!require(devtools)){install.packages("devtools")}

if (!require(pgxRpi)){devtools::install_github("progenetix/pgxRpi")}

library(pgxRpi)

```

## Step2: Search esophageal adenocarcinoma NCIt code

## Step3: Access the CNV frequency data from samples with esophageal adenocarcinoma

```{r}

freq <- pgxLoader(type = "frequency", output = "pgxseg", filters = "NCIT:C9245", codematches = T)

```

### The retreived data is an object contaning two slots `meta` and `data`.

The `meta` slot looks like this:

```{r}

freq$meta

```

The `data` slot includes two matrices.

```{r}

names(freq$data)

```

The frequency matrix looks like this

```{r}

head(freq$data$"NCIT:C9245")

```

Dimension of this matrix

```{r}

dim(freq$data$"NCIT:C9245")

```

## Step4: Visualize data

### By genome

```{r,fig.width=12,fig.height=6}

pgxFreqplot(freq)

```

### By chromosome

```{r,fig.width=12, fig.height=6}

pgxFreqplot(freq, chrom = 16)

```
```{r,fig.width=12, fig.height=6}

pgxFreqplot(freq, chrom = 1)

```


## Step5: Analyse the data

According the plot, we can see frequenct gains on chromosome 1p, 8p, 16q, 20p and frequenct losses on chromosome 1p, 8p, 11q, 13p, 16p and X both.

But on chr 16 more losses than gains. 
Chr 1q and 8q have many gains.

