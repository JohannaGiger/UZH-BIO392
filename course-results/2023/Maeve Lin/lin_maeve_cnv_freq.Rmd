---
title: "lin_maeve_cnv_freq"
author: "Maeve Lin"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Tumor information
Esophageal adenocarcinoma: choose a tumor type
google it and give a brief explanation


the ncit code is C4025

# Access the CNV frequency data

## Load library

```{r}
library(pgxRpi)
```


## Access data
```{r}
freq <- pgxLoader(type = 'frequency', output = 'pgxfreq', filters = "NCIT:C4025") # add a second filter if you want to get data of two tumors
```

the metadata information is
```{r}
freq$meta
```
progenetix has 865 samples for this tumor


the data looks like this
```{r}
freq$data$`NCIT:C4025`[c(1:3),]
```
6 columns
filter: identifier
5th column: gain frequ
6th: loss freq
last: index (not important)


# Visualization
```{r}
pgxFreqplot(freq)
```
query filter, tumor name, nr of samples
the horizontal line is the whole genome
yellow: duplication
blue: deletion frequency
get a feeling, what is the most dominant or special CNV in this tumor
which chromosomes have frequent gain or loss
the resolution is chromosome arm: the dashed line is the centromere
left is p right is q-arm
e.g. chr8: has more CNVs in the long arm

in this tumor, I set a 25% cutoff value
this is not fixed and based on the overall pattern
if you have a good reason, you can set a different cutoff value
you can set a different cutoff value for duplication and deletion


look at only one chromosome = higher resolution
```{r}
pgxFreqplot(freq, chrom = 8)
```

look at multiple chromosomes
```{r}
pgxFreqplot(freq, chrom = c(1,3,8))
```

# Analysis

based on the cutoff value, the ones with most 
frequent duplications are on: 7p, 8q, 20p, 20q
and the most frequent deletions are on: 4, 5q, 9p, 18q, 21
* now find associated literature on the tumor you're interested in
* put the study in the documentation with [link](link)  
* simple comparison: which gains did the study find, that we found as well
this is only the basic requirements

more fancy: try to analyze why there are differences, e.g. the patient had a different state
upload the rmd file but check to see whether it can be rendered